
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>soprano.utils module &#8212; Soprano beta (Boggess) documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="soprano.selection module" href="soprano.selection.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="soprano.selection.html" title="soprano.selection module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Soprano beta (Boggess) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >soprano</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="soprano.html" accesskey="U">soprano package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">soprano.utils module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-soprano.utils">
<span id="soprano-utils-module"></span><h1>soprano.utils module<a class="headerlink" href="#module-soprano.utils" title="Permalink to this headline">¶</a></h1>
<p>utils.py</p>
<p>Contains package-wide useful routines that don’t fall under any specific
category. Many of these handle common operations involving periodicity,
conversions between different representations etc.</p>
<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.abc2cart">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">abc2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.abc2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms an axes and angles representation of lattice parameters
into a Cartesian one</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.all_periodic">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">all_periodic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latt_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.all_periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all the periodic equivalent vectors for a list of vectors and a
given lattice falling within a given length.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">v (np.ndarray): list of 3-vectors representing points or vectors to</div>
<div class="line-block">
<div class="line">produce periodic versions of</div>
</div>
<div class="line">latt_cart (np.ndarray): unit cell in cartesian form</div>
<div class="line">max_r (float): maximum length of periodic copies of vectors</div>
<div class="line">pbc ([bool, bool, bool]): periodic boundary conditions - if</div>
<div class="line-block">
<div class="line">a boundary is not periodic the</div>
<div class="line">range returned will always be zero</div>
<div class="line">in that dimension</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">v_period (np.ndarray): array with the same shape as v, containing the</div>
<div class="line-block">
<div class="line">vectors in periodic reduced form</div>
</div>
<div class="line">v_index (np.ndarray): indices (referring to the original array v) of</div>
<div class="line-block">
<div class="line">the array of which the corresponding element of</div>
<div class="line">v_period is a copy</div>
</div>
<div class="line">v_cells (np.ndarray): array of triples of ints, corresponding to the</div>
<div class="line-block">
<div class="line">cells from which the various periodic copies of</div>
<div class="line">the vectors were taken. For an unchanged vector</div>
<div class="line">will be all [0,0,0]</div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.cart2abc">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">cart2abc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.cart2abc" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a Cartesian representation of lattice parameters
into an axes and angles one</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.clebsch_gordan">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">clebsch_gordan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.clebsch_gordan" title="Permalink to this definition">¶</a></dt>
<dd><p>Clebsch-Gordan cohefficients for given quantum numbers:
j, m, j1, m1, j2, m2</p>
<p>The numbers passed can be arrays (just make sure they’re the
same size).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.compute_asymmetric_distmat">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">compute_asymmetric_distmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linearized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.compute_asymmetric_distmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a symmetric structure, compute a distance matrix for the given
fractional coordinate points which contains only the distances between
their closest symmetry equivalent sites in the asymmetric unit cell.</p>
<p>Distances are computed in <em>fractional coordinates</em> space and are not
real distances. They do not necessarily map to real space distances
either. Their purpose is merely to group points together by removing the
effects of symmetry operations.</p>
<div class="line-block">
<div class="line">Parameters:</div>
<div class="line-block">
<div class="line">struct (ase.Atoms): the structure from which to extract the symmetry</div>
<div class="line-block">
<div class="line">operations</div>
</div>
<div class="line">points (np.ndarray): list of points, in fractional coordinates, to</div>
<div class="line-block">
<div class="line">compute the distance matrix for</div>
</div>
<div class="line">linearized (bool):  if True, returns only the linearised upper</div>
<div class="line-block">
<div class="line">triangle of the distance matrix, in the format</div>
<div class="line">accepted by scipy.cluster.hierarchy.linkage.</div>
<div class="line">Default is True</div>
</div>
<div class="line">return_images (bool): if True, return also a list of the closest</div>
<div class="line-block">
<div class="line">images for each point. The closest</div>
<div class="line">symmetric image to images_centre is chosen.</div>
</div>
<div class="line">images_centre (int or np.ndarray): centre to use to compute closest</div>
<div class="line-block">
<div class="line">images. If an integer, uses the</div>
<div class="line">given point of that index. If a</div>
<div class="line">vector, uses the given coordinates.</div>
<div class="line">Should not be a high symmetry point.</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">distmat (np.ndarray): distance matrix for points</div>
<div class="line">images (np.ndarray): closest point images (only if return_images is</div>
<div class="line-block">
<div class="line">True)</div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.customize_warnings">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">customize_warnings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.customize_warnings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.get_bonding_distance">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">get_bonding_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.get_bonding_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance in bonds, returns -1 if the two are not connected</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.get_bonding_graph">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">get_bonding_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.get_bonding_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.get_sklearn_clusters">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">get_sklearn_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.get_sklearn_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster points using given method if found in sklearn.clusters module.
Use params as a dictionary of parameters passed to the method.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.graph_specsort">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">graph_specsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.graph_specsort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.hkl2d2_matgen">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">hkl2d2_matgen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.hkl2d2_matgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a matrix that turns hkl indices into inverse crystal
plane distances for a given lattice in ABC form</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.import_module">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">import_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.import_module" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.inspect_args">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">inspect_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.inspect_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.inv_plane_dist">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">inv_plane_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hkl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hkl2d2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.inv_plane_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate inverse planar distance for a given set of
Miller indices h, k, l.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.is_string">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">is_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.is_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether s is a string, with Python 2 and 3 compatibility</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.list_distance">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">list_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.list_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an integer distance between two lists (number of differing
elements)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.max_distance_in_cell">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">max_distance_in_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.max_distance_in_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum distance between two points achievable inside a single unit
cell.
Relies on the fact that the isosurface for equal distance in cartesian
space is an ellipsoid, meaning that the extreme has to be one of the 8
corners of the cube of side 1 in fractional space.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.minimum_periodic">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">minimum_periodic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latt_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.minimum_periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the shortest periodic equivalent vector for a list of vectors and a
given lattice.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">v (np.ndarray): list of 3-vectors representing points or vectors to</div>
<div class="line-block">
<div class="line">reduce to their closest periodic version</div>
</div>
<div class="line">latt_cart (np.ndarray): unit cell in cartesian form</div>
<div class="line">exclude_self (bool): if True, any vector that is equal to zero will be</div>
<div class="line-block">
<div class="line">excluded, and its closest non-zero periodic</div>
<div class="line">version will be considered instead. Default is</div>
<div class="line">False</div>
</div>
<div class="line">pbc ([bool, bool, bool]): periodic boundary conditions - if</div>
<div class="line-block">
<div class="line">a boundary is not periodic the</div>
<div class="line">range returned will always be zero</div>
<div class="line">in that dimension</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">v_period (np.ndarray): array with the same shape as v, containing the</div>
<div class="line-block">
<div class="line">vectors in periodic reduced form</div>
</div>
<div class="line">v_cells (np.ndarray): array of triples of ints, corresponding to the</div>
<div class="line-block">
<div class="line">cells from which the various periodic copies of</div>
<div class="line">the vectors were taken. For an unchanged vector</div>
<div class="line">will be all [0,0,0]</div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.minimum_supcell">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">minimum_supcell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latt_cart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.minimum_supcell" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the bounds for a supercell containing a sphere
of given radius, knowing the unit cell.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">max_r (float): radius of the sphere contained in the supercell</div>
<div class="line">latt_cart (np.ndarray): unit cell in cartesian form</div>
<div class="line">r_matrix (np.ndarray): matrix for the quadratic form returning</div>
<div class="line-block">
<div class="line">r^2 for this supercell.</div>
<div class="line">Alternative to latt_cart, for a direct</div>
<div class="line">space cell would be equal to</div>
<div class="line">np.dot(latt_cart, latt_cart.T)</div>
</div>
<div class="line">pbc ([bool, bool, bool]): periodic boundary conditions - if</div>
<div class="line-block">
<div class="line">a boundary is not periodic the</div>
<div class="line">range returned will always be zero</div>
<div class="line">in that dimension</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">shape (tuple[int]):  shape of the supercell to be built.</div>
</div>
</div>
<div class="line-block">
<div class="line">Raises:</div>
<div class="line-block">
<div class="line">ValueError: if some of the arguments are invalid</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.periodic_bridson">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">periodic_bridson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepoints_cuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxblock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.periodic_bridson" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodic version of the Bridson algorithm for generation of Poisson
sphere distributions of points. This returns a generator.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">cell (np.ndarray): periodic cell in which to create the points.</div>
<div class="line">rmin (float): minimum distance between each generated point.</div>
<div class="line">max_attempts (int): maximum number of candidate neighbours generated</div>
<div class="line-block">
<div class="line">for each point.</div>
</div>
<div class="line">prepoints (np.ndarray or list): pre-existing points to avoid during</div>
<div class="line-block">
<div class="line">generation. These must be in</div>
<div class="line">fractional coordinates.</div>
</div>
<div class="line">prepoints_cuts (np.ndarray or list): custom cutoffs for each prepoint.</div>
<div class="line-block">
<div class="line">If not included defaults to rmin.</div>
</div>
<div class="line">maxblock (int):     maximum size of a grid block to be processed in a</div>
<div class="line-block">
<div class="line">single function (used to avoid excess memory use)</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">bridsonGen (generator): an iterator producing Poisson-sphere like</div>
<div class="line-block">
<div class="line">distributed points in cell until space runs</div>
<div class="line">out or enough attempts fail.</div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.progbar">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">progbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spinner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.progbar" title="Permalink to this definition">¶</a></dt>
<dd><p>A textual progress bar for the command line</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">i (int): current progress index</div>
<div class="line">max_i (int): final progress index</div>
<div class="line">bar_len (Optional[int]): length in characters of the bar (no brackets)</div>
<div class="line">spinner (Optional[bool]): show a spinner at the end</div>
<div class="line">spin_rate (Optional[float]): spinner rotation speed (turns per full</div>
<div class="line-block">
<div class="line">progress)</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">bar (str): a progress bar formatted as requested</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.recursive_mol_label">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">recursive_mol_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elems</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.recursive_mol_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a string for a given atom by traversing the molecular network
starting with it.</p>
<div class="line-block">
<div class="line">Parameters:</div>
<div class="line-block">
<div class="line">site_i (int): index of the atom for which the string must be</div>
<div class="line-block">
<div class="line">calculated</div>
</div>
<div class="line">mol_indices ([int]): indices of all atoms belonging to the molecule</div>
<div class="line">bonds (dict): dictionary of bonds within the molecule, containing</div>
<div class="line-block">
<div class="line">the indices of atoms as keys and lists of all the</div>
<div class="line">indices of atoms they’re bonded to as values.</div>
</div>
<div class="line">elems ([str]): list of element symbols for the entire system (must</div>
<div class="line-block">
<div class="line">be returned by ase.Atoms’ get_chemical_symbols, NOT</div>
<div class="line">follow the order the atoms appear in mol_indices)</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">recursive_label (str): a string representing the molecular network</div>
<div class="line-block">
<div class="line">traversed starting from site i</div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.rep_alg">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">rep_alg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.rep_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>Repulsion algorithm, begins with a series of vectors v, finds a new one
that is as far as possible, angle-wise, from all of them.
The process is that of treating the tips of the vectors as particles on a
sphere which repel each other. Of course, it’s possible that multiple
equilibrium positions exist, which is why multiple attempts can be made,
and are judged identical or not based on a tolerance parameter</p>
<div class="line-block">
<div class="line">Parameters:</div>
<div class="line-block">
<div class="line">v (np.ndarray): list of fixed vectors to avoid</div>
<div class="line">iters (int): number of iterations, default is 1000</div>
<div class="line">attempts (int): number of independent attempts with randomised starts,</div>
<div class="line-block">
<div class="line">default is 10</div>
</div>
<div class="line">step (float): step by which the ‘particle’ describing the vector will</div>
<div class="line-block">
<div class="line">be displaced at each iteration during the search.</div>
<div class="line">Default is 1e-1.</div>
</div>
<div class="line">simtol (float): tolerance based on which two attempts are considered to</div>
<div class="line-block">
<div class="line">be effectively the same, checking if 1-v1.v2 &lt; simtol.</div>
<div class="line">Default is 1e-5.</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">out_v ([np.ndarray]): list of unit vectors of maximal distance from</div>
<div class="line-block">
<div class="line">the ones in v</div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.replace_folder">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">replace_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_folder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.replace_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the folder of the given path with a new one</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.safe_communicate">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">safe_communicate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subproc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.safe_communicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a Popen.communicate and returns output in a way that is
compatible with Python 2 &amp; 3 keeping input and output as strings (since
Python 3 requires bytes objects otherwise)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.safe_input">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">safe_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">question</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.safe_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Ask for user input with Python 2 and 3 compatibility</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.seedname">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">seedname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.seedname" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the filename (with no extension) from a full path</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.silence_stdio">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">silence_stdio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">silence_stdout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silence_stderr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.silence_stdio" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful stdout/err silencer</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.supcell_gridgen">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">supcell_gridgen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latt_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.supcell_gridgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a full linearized grid for a supercell with r_bounds
and a base unit cell in Cartesian form.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">latt_cart (np.ndarray): unit cell in cartesian form</div>
<div class="line">shape (tuple[int]):  shape of the supercell to be built,</div>
<div class="line-block">
<div class="line">as returned by minimum_supcell.</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">neigh_i_grid (np.ndarray): supercell grid in fractional coordinates</div>
<div class="line">neigh_grid (np.ndarray): supercell grid in cartesian coordinates</div>
</div>
</div>
<div class="line-block">
<div class="line">Raises:</div>
<div class="line-block">
<div class="line">ValueError: if some of the arguments are invalid</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.swing_twist_decomp">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">swing_twist_decomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.swing_twist_decomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a Swing*Twist decomposition of a Quaternion. This splits the
quaternion in two: one containing the rotation around axis (Twist), the
other containing the rotation around a vector parallel to axis (Swing).</p>
<p>Returns two quaternions: Swing, Twist.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="soprano.utils.wigner_3j">
<span class="sig-prename descclassname"><span class="pre">soprano.utils.</span></span><span class="sig-name descname"><span class="pre">wigner_3j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#soprano.utils.wigner_3j" title="Permalink to this definition">¶</a></dt>
<dd><p>Wigner 3j symbols for given quantum numbers:</p>
<p>/                     | j1    j2     j3 |
| m1    m2     m3 |
                /</p>
<p>The numbers passed can be arrays (just make sure they’re the
same size).</p>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">soprano</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="soprano.html">soprano package</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="soprano.selection.html"
                        title="previous chapter">soprano.selection module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/doctree/soprano.utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="soprano.selection.html" title="soprano.selection module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Soprano beta (Boggess) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >soprano</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="soprano.html" >soprano package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">soprano.utils module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Simone Sturniolo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>